---
title: "The Deeper Structures of Late Global Capitalism: Eora26"
author: "Julio Huato"
date: "6/9/2020"
output:
  bookdown::html_document2: default
  bookdown::pdf_document2: default
bibliography: bib.bib
---

# Purpose

This work is the part of the project *The Deeper Structures of Late Global Capitalism* based on the Eora26 data sets.^[@eora26] For each 

- industry $i, j \in [1, 26]$, 
- country $k \in [1, 189]$, and 
- year $t \in [1990, 2015]$, this work aims to extract, plot, and analyze time series (1990-2015) of:

1. The rate of surplus value, 
$$\sigma_{i; k; t} \equiv \frac{\Pi_{i; k; t}}{W_{i; k; t}}$$,
2. the capital composition, 
$$h_{i; k; t} \equiv \frac{\sum_{j=1}^{26} q_{j, i; k; t}}{W_{i; k; t} }$$, 
3. the "capital productivity," 
$$\gamma_{i; k; t} \equiv \frac{Y_{i; k; t}}{\sum_{j=1}^{26} q_{j,i; k; t}},$$ and
4. the profit rate, 
$$r_{i; k; t} \equiv \frac{\Pi_{i; k; t}}{\sum_{j=1}^{26} q_{j,i; k; t}}.$$

# Data

The Eora26 database used in this work is an abbreviated version of the fuller Eora MRIO international supply-use data base.  The Eora MRIO supply-use tables are converted into the Eora26 input-output tables, aggregating all economic activity into 26 sectors, using methods described in detail in @eora26, @eurostat2008, @lenzen2013, and @lenzen2012.  

"Each zipfile contains the MRIO data in tab-separated .txt files, divided into the transactions matrix T, primary inputs (also called value added) VA, final demand block FD, and satellite accounts (also called environmental extensions or stressors) Q (Q for emissions associated with production, QY for direct emissions by final consumers). Metadata labels are provided in separate .txt files. The unzipped data are ~200MB for each year."^[@eora26.  The version of the data used is v199.82.]

The Eora26 data sets cover 189 countries, 26 sectors, and 26 years: from 1990 to 2015.  More specifically:

- Eora26_year_bp_T.txt: The transactions table contains, for each country $k \in [1, 189]$ and year $t \in [1990, 2015]$, the intermediate supplies of each industry $i$ to industry $j$: $q_{i,j}$, for $i, j \in [1, 26]$.
- Eora26_year_bp_VA.txt: The value added table contains, for each industry $i \in [1, 26]$, country $k \in [1, 160]$ and year $t \in [1990, 2015]$,
  - Wages ("Compensation of employees D.1"), 
  - Prod taxes ("Taxes on production D.29"), 
  - Prod subsidies ("Subsidies on production D.39"), 
  - Profits ("Net operating surplus B.2n"), 
  - Net mixed income ("Net mixed income B.3n"), and
  - Depreciation ("Consumption of fixed capital K.1").
- Eora26_year_bp_FD.txt: The final demand table contains, for each industry $i \in [1, 26]$, country $k \in [1, 160]$ and year $t \in [1990, 2015]$,
  - Household final consumption P.3h,
  - Non-profit institutions serving households P.3n,
  - Government final consumption P.3g,
  - Gross fixed capital formation P.51,
  - Changes in inventories P.52, and
  - Acquisitions less disposals of valuables P.53.

Source: https://worldmrio.com/eora26/


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Data download

# HELP!!!
I am at this point, Lara.  I am trying to write a loop function to download all the data files directly from the web site into R.  Since these are zipped file arrays, I need R to unzip the zip files, which when unzipped create folders with the data files in it.  Then I need to pull each of the T, VA, and FD files into R and then perform all the procedures needed to create the time series listed above. 

Here's what I have so far:

```{r}
# This create the vector of the data years
year <- c(1990:2015) 
# This creates the URLs to direct R to pull the data in
urls <- paste("https://worldmrio.com/ComputationsM/Phase199/Loop082/simplified/Eora26_", as.character(year[i]),"_bp.zip", sep="")
# WARNING: The following is not yet debugged.
# I took this from here:
# https://stackoverflow.com/questions/3053833/using-r-to-download-zipped-data-file-extract-and-import-data
# This has to be done in a loop:
temp <- tempfile()
download.file(urls[i],temp) # ???
con <- unz(temp, "x.") # ???
data <- matrix(scan(con),ncol=???, byrow=TRUE) # ???
unlink(temp)



```


# Plots

Plots here.

# References
